# Copyright 2017 the pycolab Authors
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     https://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

"""An implementation of the environments from 'World Discovery Models'[https://arxiv.org/pdf/1902.07685.pdf]. 
Learn to explore!

This environment uses a simple scrolling mechanism: cropping! As far as the pycolab engine is concerned, 
the game world doesn't scroll at all: it just renders observations that are the size
of the entire map. Only later do "cropper" objects crop out a part of the
observation to give the impression of a moving world/partial observability.

Keys: up, down, left, right - move. q - quit.
"""

from __future__ import absolute_import
from __future__ import division
from __future__ import print_function

import random
import curses

import sys
import numpy as np

from pycolab import ascii_art
from pycolab import cropping
from pycolab import human_ui
from pycolab import things as plab_things
from pycolab.prefab_parts import sprites as prefab_sprites

# pylint: disable=line-too-long
MAZES_ART = [
    # Each maze in MAZES_ART must have exactly one of the object sprites
    # 'a', 'b', 'c', 'd' and 'e', 'f', 'g', 'h'. I guess if you really don't want them in your maze
    # can always put them down in an unreachable part of the map or something.
    #
    # Make sure that the Player will have no way to "escape" the maze.
    #
    # Legend:
    #     '#': impassable walls.            'a': fixed object A.
    #     'P': player starting location.    'b': fixed object B.
    #     ' ': boring old maze floor.       'c': fixed object C.
    #                                       'd': fixed object D.
    #                                       'e': fixed object E.
    #                                       'f': fixed object F.
    #                                       'g': fixed object G.
    #                                       'h': fixed object H.
    #
    # Room layout:
    # 8 1 2
    # 7 0 3
    # 6 5 4
    ['#####################################################################################',
    '####################                                             ####################',
    '###############   ###                                           ###   ###############',
    '##############     ###                                         ###     ##############',
    '#############       ###                                       ###       #############',
    '############         ###                                     ###         ############',
    '###########           ###                                    ##           ###########',
    '##########             ##                                    ##            ##########',
    '#########              ##                                   ###             #########',
    '########               ###                                 ###               ########',
    '#######                 ###                               ###                 #######',
    '######                   ###              a              ###                   ######',
    '#####                     ###                           ###                     #####',
    '####                       ###                         ###                       ####',
    '###                         ###                       ###                         ###',
    '##                           ###                     ###                           ##',
    '##                            ####                 ####                            ##',
    '##                             ##########   ##########                             ##',
    '###                             ##      #   #      ##                             ###',
    '####              h             ##      #   #      ##                            ####',
    '# ###                           ##      #   #      ##                           ### #',
    '#  ###                          ##      #   #      ##           b              ###  #',
    '#   #####                       ##      #   #      ##                       #####   #',
    '#    #####                     ##       #   #       ##                     #####    #',
    '#       ###                   ##        #   #        ##                   ###       #',
    '#        ###                 ##         #   #         ##                 ###        #',
    '#         ###                ##         #   #         ##                ###         #',
    '#          ###                ##        #   #        ##                ###          #',
    '#           ###                ##       #   #       ##                ###           #',
    '#            ###         ##     ##      #   #      ##     ##         ###            #',
    '#             ###       ####     ##     #   #     ##     ####       ###             #',
    '#              ###     ##  ##     ##    #   #    ##     ##  ##     ###              #',
    '#               ########    ##     ##   #   #   ##     ##    ########               #',
    '#               #######      ##     ##  #   #  ##     ##      #######               #',
    '#                #            ##     ## #   # ##     ##            #                #',
    '#                #             ##     ###   ###     ##             #                #',
    '#                #              ##                 ##              #                #',
    '#                #               ##               ##               #                #',
    '#                #                ##             ##                #                #',
    '#                #                 #             #                 #                #',
    '#                ###################             ###################                #',
    '#                                                                                   #',
    '#                                         P                               c         #',
    '#        g                                                                          #',
    '#                ###################             ###################                #',
    '#                #                 #             #                 #                #',
    '#                #                ##             ##                #                #',
    '#                #               ##               ##               #                #',
    '#                #              ##                 ##              #                #',
    '#                #             ##     ###   ###     ##             #                #',
    '#                #            ##     ## #   # ##     ##            #                #',
    '#               #######      ##     ##  #   #  ##     ##      #######               #',
    '#               ########    ##     ##   #   #   ##     ##    ########               #',
    '#              ###     ##  ##     ##    #   #    ##     ##  ##     ###              #',
    '#             ###       ####     ##     #   #     ##     ####       ###             #',
    '#            ###         ##     ##      #   #      ##     ##         ###            #',
    '#           ###                ##       #   #       ##                ###           #',
    '#          ###                ##        #   #        ##                ###          #',
    '#         ###                ##         #   #         ##                ###         #',
    '#        ###                 ##         #   #         ##                 ###        #',
    '#       ###                   ##        #   #        ##                   ###       #',
    '#    #####                     ##       #   #       ##                     #####    #',
    '#   #####          f            ##      #   #      ##                       #####   #',
    '#  ###                          ##      #   #      ##           d              ###  #',
    '# ###                           ##      #   #      ##                           ### #',
    '####                            ##      #   #      ##                            ####',
    '###                             ##      #   #      ##                             ###',
    '##                             ##########   ##########                             ##',
    '##                            ####                 ####                            ##',
    '##                           ###                     ###                           ##',
    '###                         ###                       ###                         ###',
    '####                       ###            e            ###                       ####',
    '#####                     ###                           ###                     #####',
    '######                   ###                             ###                   ######',
    '#######                 ###                               ###                 #######',
    '########               ###                                 ###               ########',
    '#########             ###                                   ###             #########',
    '##########            ##                                     ##            ##########',
    '###########           ##                                     ##           ###########',
    '############         ###                                     ###         ############',
    '#############       ###                                       ###       #############',
    '##############     ###                                         ###     ##############',
    '###############   ###                                           ###   ###############',
    '####################                                             ####################',
    '#####################################################################################']
]

# These colours are only for humans to see in the CursesUi.
COLOUR_FG = {' ': (0, 0, 0),        # Default black background
             '#': (764, 0, 999),    # Walls of the maze
             'P': (0, 999, 999),    # This is you, the player
             'a': (999, 0, 780),    # Patroller A
             'b': (145, 987, 341),   # Patroller B
             'c': (252, 186, 3),
             'd': (3, 240, 252),
             'e': (240, 3, 252),
             'f': (252, 28, 3),
             'g': (136, 3, 252),
             'h': (20, 145, 60)}

COLOUR_BG = {'@': (0, 0, 0)}  # So the coins look like @ and not solid blocks.

ENEMIES = {'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h'} # Globally accessible set of sprites

# Empty coordinates corresponding to each numbered room (width 1 passageways not blocked)
ROOMS = {0: [[36, 38], [36, 39], [36, 40], [36, 41], [36, 42], [36, 43], [36, 44], [36, 45], [36, 46], [37, 37], [37, 38], [37, 39], [37, 40], [37, 41], [37, 42], [37, 43], [37, 44], [37, 45], [37, 46], [37, 47], [38, 36], [38, 37], [38, 38], [38, 39], [38, 40], [38, 41], [38, 42], [38, 43], [38, 44], [38, 45], [38, 46], [38, 47], [38, 48], [39, 36], [39, 37], [39, 38], [39, 39], [39, 40], [39, 41], [39, 42], [39, 43], [39, 44], [39, 45], [39, 46], [39, 47], [39, 48], [40, 36], [40, 37], [40, 38], [40, 39], [40, 40], [40, 41], [40, 42], [40, 43], [40, 44], [40, 45], [40, 46], [40, 47], [40, 48], [41, 36], [41, 37], [41, 38], [41, 39], [41, 40], [41, 41], [41, 42], [41, 43], [41, 44], [41, 45], [41, 46], [41, 47], [41, 48], [42, 36], [42, 37], [42, 38], [42, 39], [42, 40], [42, 41], [42, 42], [42, 43], [42, 44], [42, 45], [42, 46], [42, 47], [42, 48], [43, 36], [43, 37], [43, 38], [43, 39], [43, 40], [43, 41], [43, 42], [43, 43], [43, 44], [43, 45], [43, 46], [43, 47], [43, 48], [44, 36], [44, 37], [44, 38], [44, 39], [44, 40], [44, 41], [44, 42], [44, 43], [44, 44], [44, 45], [44, 46], [44, 47], [44, 48], [45, 36], [45, 37], [45, 38], [45, 39], [45, 40], [45, 41], [45, 42], [45, 43], [45, 44], [45, 45], [45, 46], [45, 47], [45, 48], [46, 36], [46, 37], [46, 38], [46, 39], [46, 40], [46, 41], [46, 42], [46, 43], [46, 44], [46, 45], [46, 46], [46, 47], [46, 48], [47, 37], [47, 38], [47, 39], [47, 40], [47, 41], [47, 42], [47, 43], [47, 44], [47, 45], [47, 46], [47, 47], [48, 38], [48, 39], [48, 40], [48, 41], [48, 42], [48, 43], [48, 44], [48, 45], [48, 46]], 
         1: [[2, 22], [2, 23], [2, 24], [2, 25], [2, 26], [2, 27], [2, 28], [2, 29], [2, 30], [2, 31], [2, 32], [2, 33], [2, 34], [2, 35], [2, 36], [2, 37], [2, 38], [2, 39], [2, 40], [2, 41], [2, 42], [2, 43], [2, 44], [2, 45], [2, 46], [2, 47], [2, 48], [2, 49], [2, 50], [2, 51], [2, 52], [2, 53], [2, 54], [2, 55], [2, 56], [2, 57], [2, 58], [2, 59], [2, 60], [2, 61], [2, 62], [3, 23], [3, 24], [3, 25], [3, 26], [3, 27], [3, 28], [3, 29], [3, 30], [3, 31], [3, 32], [3, 33], [3, 34], [3, 35], [3, 36], [3, 37], [3, 38], [3, 39], [3, 40], [3, 41], [3, 42], [3, 43], [3, 44], [3, 45], [3, 46], [3, 47], [3, 48], [3, 49], [3, 50], [3, 51], [3, 52], [3, 53], [3, 54], [3, 55], [3, 56], [3, 57], [3, 58], [3, 59], [3, 60], [3, 61], [4, 24], [4, 25], [4, 26], [4, 27], [4, 28], [4, 29], [4, 30], [4, 31], [4, 32], [4, 33], [4, 34], [4, 35], [4, 36], [4, 37], [4, 38], [4, 39], [4, 40], [4, 41], [4, 42], [4, 43], [4, 44], [4, 45], [4, 46], [4, 47], [4, 48], [4, 49], [4, 50], [4, 51], [4, 52], [4, 53], [4, 54], [4, 55], [4, 56], [4, 57], [4, 58], [4, 59], [4, 60], [5, 25], [5, 26], [5, 27], [5, 28], [5, 29], [5, 30], [5, 31], [5, 32], [5, 33], [5, 34], [5, 35], [5, 36], [5, 37], [5, 38], [5, 39], [5, 40], [5, 41], [5, 42], [5, 43], [5, 44], [5, 45], [5, 46], [5, 47], [5, 48], [5, 49], [5, 50], [5, 51], [5, 52], [5, 53], [5, 54], [5, 55], [5, 56], [5, 57], [5, 58], [5, 59], [6, 26], [6, 27], [6, 28], [6, 29], [6, 30], [6, 31], [6, 32], [6, 33], [6, 34], [6, 35], [6, 36], [6, 37], [6, 38], [6, 39], [6, 40], [6, 41], [6, 42], [6, 43], [6, 44], [6, 45], [6, 46], [6, 47], [6, 48], [6, 49], [6, 50], [6, 51], [6, 52], [6, 53], [6, 54], [6, 55], [6, 56], [6, 57], [6, 58], [6, 59], [7, 26], [7, 27], [7, 28], [7, 29], [7, 30], [7, 31], [7, 32], [7, 33], [7, 34], [7, 35], [7, 36], [7, 37], [7, 38], [7, 39], [7, 40], [7, 41], [7, 42], [7, 43], [7, 44], [7, 45], [7, 46], [7, 47], [7, 48], [7, 49], [7, 50], [7, 51], [7, 52], [7, 53], [7, 54], [7, 55], [7, 56], [7, 57], [7, 58], [7, 59], [8, 26], [8, 27], [8, 28], [8, 29], [8, 30], [8, 31], [8, 32], [8, 33], [8, 34], [8, 35], [8, 36], [8, 37], [8, 38], [8, 39], [8, 40], [8, 41], [8, 42], [8, 43], [8, 44], [8, 45], [8, 46], [8, 47], [8, 48], [8, 49], [8, 50], [8, 51], [8, 52], [8, 53], [8, 54], [8, 55], [8, 56], [8, 57], [8, 58], [9, 27], [9, 28], [9, 29], [9, 30], [9, 31], [9, 32], [9, 33], [9, 34], [9, 35], [9, 36], [9, 37], [9, 38], [9, 39], [9, 40], [9, 41], [9, 42], [9, 43], [9, 44], [9, 45], [9, 46], [9, 47], [9, 48], [9, 49], [9, 50], [9, 51], [9, 52], [9, 53], [9, 54], [9, 55], [9, 56], [9, 57], [10, 28], [10, 29], [10, 30], [10, 31], [10, 32], [10, 33], [10, 34], [10, 35], [10, 36], [10, 37], [10, 38], [10, 39], [10, 40], [10, 41], [10, 42], [10, 43], [10, 44], [10, 45], [10, 46], [10, 47], [10, 48], [10, 49], [10, 50], [10, 51], [10, 52], [10, 53], [10, 54], [10, 55], [10, 56], [11, 29], [11, 30], [11, 31], [11, 32], [11, 33], [11, 34], [11, 35], [11, 36], [11, 37], [11, 38], [11, 39], [11, 40], [11, 41], [11, 42], [11, 43], [11, 44], [11, 45], [11, 46], [11, 47], [11, 48], [11, 49], [11, 50], [11, 51], [11, 52], [11, 53], [11, 54], [11, 55], [12, 30], [12, 31], [12, 32], [12, 33], [12, 34], [12, 35], [12, 36], [12, 37], [12, 38], [12, 39], [12, 40], [12, 41], [12, 42], [12, 43], [12, 44], [12, 45], [12, 46], [12, 47], [12, 48], [12, 49], [12, 50], [12, 51], [12, 52], [12, 53], [12, 54], [13, 31], [13, 32], [13, 33], [13, 34], [13, 35], [13, 36], [13, 37], [13, 38], [13, 39], [13, 40], [13, 41], [13, 42], [13, 43], [13, 44], [13, 45], [13, 46], [13, 47], [13, 48], [13, 49], [13, 50], [13, 51], [13, 52], [13, 53], [14, 32], [14, 33], [14, 34], [14, 35], [14, 36], [14, 37], [14, 38], [14, 39], [14, 40], [14, 41], [14, 42], [14, 43], [14, 44], [14, 45], [14, 46], [14, 47], [14, 48], [14, 49], [14, 50], [14, 51], [14, 52]], 
         2: [[3, 67], [4, 66], [4, 67], [4, 68], [5, 65], [5, 66], [5, 67], [5, 68], [5, 69], [6, 64], [6, 65], [6, 66], [6, 67], [6, 68], [6, 69], [6, 70], [7, 64], [7, 65], [7, 66], [7, 67], [7, 68], [7, 69], [7, 70], [7, 71], [8, 64], [8, 65], [8, 66], [8, 67], [8, 68], [8, 69], [8, 70], [8, 71], [8, 72], [9, 63], [9, 64], [9, 65], [9, 66], [9, 67], [9, 68], [9, 69], [9, 70], [9, 71], [9, 72], [9, 73], [10, 62], [10, 63], [10, 64], [10, 65], [10, 66], [10, 67], [10, 68], [10, 69], [10, 70], [10, 71], [10, 72], [10, 73], [10, 74], [11, 61], [11, 62], [11, 63], [11, 64], [11, 65], [11, 66], [11, 67], [11, 68], [11, 69], [11, 70], [11, 71], [11, 72], [11, 73], [11, 74], [11, 75], [12, 60], [12, 61], [12, 62], [12, 63], [12, 64], [12, 65], [12, 66], [12, 67], [12, 68], [12, 69], [12, 70], [12, 71], [12, 72], [12, 73], [12, 74], [12, 75], [12, 76], [13, 59], [13, 60], [13, 61], [13, 62], [13, 63], [13, 64], [13, 65], [13, 66], [13, 67], [13, 68], [13, 69], [13, 70], [13, 71], [13, 72], [13, 73], [13, 74], [13, 75], [13, 76], [13, 77], [14, 58], [14, 59], [14, 60], [14, 61], [14, 62], [14, 63], [14, 64], [14, 65], [14, 66], [14, 67], [14, 68], [14, 69], [14, 70], [14, 71], [14, 72], [14, 73], [14, 74], [14, 75], [14, 76], [14, 77], [14, 78], [15, 57], [15, 58], [15, 59], [15, 60], [15, 61], [15, 62], [15, 63], [15, 64], [15, 65], [15, 66], [15, 67], [15, 68], [15, 69], [15, 70], [15, 71], [15, 72], [15, 73], [15, 74], [15, 75], [15, 76], [15, 77], [15, 78], [15, 79], [16, 56], [16, 57], [16, 58], [16, 59], [16, 60], [16, 61], [16, 62], [16, 63], [16, 64], [16, 65], [16, 66], [16, 67], [16, 68], [16, 69], [16, 70], [16, 71], [16, 72], [16, 73], [16, 74], [16, 75], [16, 76], [16, 77], [16, 78], [16, 79], [16, 80], [17, 55], [17, 56], [17, 57], [17, 58], [17, 59], [17, 60], [17, 61], [17, 62], [17, 63], [17, 64], [17, 65], [17, 66], [17, 67], [17, 68], [17, 69], [17, 70], [17, 71], [17, 72], [17, 73], [17, 74], [17, 75], [17, 76], [17, 77], [17, 78], [17, 79], [17, 80], [17, 81], [18, 54], [18, 55], [18, 56], [18, 57], [18, 58], [18, 59], [18, 60], [18, 61], [18, 62], [18, 63], [18, 64], [18, 65], [18, 66], [18, 67], [18, 68], [18, 69], [18, 70], [18, 71], [18, 72], [18, 73], [18, 74], [18, 75], [18, 76], [18, 77], [18, 78], [18, 79], [18, 80], [19, 54], [19, 55], [19, 56], [19, 57], [19, 58], [19, 59], [19, 60], [19, 61], [19, 62], [19, 63], [19, 64], [19, 65], [19, 66], [19, 67], [19, 68], [19, 69], [19, 70], [19, 71], [19, 72], [19, 73], [19, 74], [19, 75], [19, 76], [19, 77], [19, 78], [19, 79], [20, 54], [20, 55], [20, 56], [20, 57], [20, 58], [20, 59], [20, 60], [20, 61], [20, 62], [20, 63], [20, 64], [20, 65], [20, 66], [20, 67], [20, 68], [20, 69], [20, 70], [20, 71], [20, 72], [20, 73], [20, 74], [20, 75], [20, 76], [20, 77], [20, 78], [21, 55], [21, 56], [21, 57], [21, 58], [21, 59], [21, 60], [21, 61], [21, 62], [21, 63], [21, 64], [21, 65], [21, 66], [21, 67], [21, 68], [21, 69], [21, 70], [21, 71], [21, 72], [21, 73], [21, 74], [21, 75], [22, 56], [22, 57], [22, 58], [22, 59], [22, 60], [22, 61], [22, 62], [22, 63], [22, 64], [22, 65], [22, 66], [22, 67], [22, 68], [22, 69], [22, 70], [22, 71], [22, 72], [22, 73], [22, 74], [23, 57], [23, 58], [23, 59], [23, 60], [23, 61], [23, 62], [23, 63], [23, 64], [23, 65], [23, 66], [23, 67], [23, 68], [23, 69], [23, 70], [23, 71], [23, 72], [23, 73], [24, 58], [24, 59], [24, 60], [24, 61], [24, 62], [24, 63], [24, 64], [24, 65], [24, 66], [24, 67], [24, 68], [24, 69], [24, 70], [24, 71], [24, 72], [25, 59], [25, 60], [25, 61], [25, 62], [25, 63], [25, 64], [25, 65], [25, 66], [25, 67], [25, 68], [25, 69], [25, 70], [25, 71], [26, 60], [26, 61], [26, 62], [26, 63], [26, 64], [26, 65], [26, 66], [26, 67], [26, 68], [26, 69], [26, 70], [27, 61], [27, 62], [27, 63], [27, 64], [27, 65], [27, 66], [27, 67], [27, 68], [27, 69], [28, 62], [28, 63], [28, 64], [28, 65], [28, 66], [28, 67], [28, 68], [29, 63], [29, 64], [29, 65], [29, 66], [29, 67], [30, 64], [30, 65], [30, 66]], 
         3: [[22, 82], [23, 81], [23, 82], [24, 80], [24, 81], [24, 82], [25, 77], [25, 78], [25, 79], [25, 80], [25, 81], [25, 82], [26, 76], [26, 77], [26, 78], [26, 79], [26, 80], [26, 81], [26, 82], [27, 75], [27, 76], [27, 77], [27, 78], [27, 79], [27, 80], [27, 81], [27, 82], [28, 74], [28, 75], [28, 76], [28, 77], [28, 78], [28, 79], [28, 80], [28, 81], [28, 82], [29, 73], [29, 74], [29, 75], [29, 76], [29, 77], [29, 78], [29, 79], [29, 80], [29, 81], [29, 82], [30, 72], [30, 73], [30, 74], [30, 75], [30, 76], [30, 77], [30, 78], [30, 79], [30, 80], [30, 81], [30, 82], [31, 71], [31, 72], [31, 73], [31, 74], [31, 75], [31, 76], [31, 77], [31, 78], [31, 79], [31, 80], [31, 81], [31, 82], [32, 70], [32, 71], [32, 72], [32, 73], [32, 74], [32, 75], [32, 76], [32, 77], [32, 78], [32, 79], [32, 80], [32, 81], [32, 82], [33, 70], [33, 71], [33, 72], [33, 73], [33, 74], [33, 75], [33, 76], [33, 77], [33, 78], [33, 79], [33, 80], [33, 81], [33, 82], [34, 70], [34, 71], [34, 72], [34, 73], [34, 74], [34, 75], [34, 76], [34, 77], [34, 78], [34, 79], [34, 80], [34, 81], [34, 82], [35, 70], [35, 71], [35, 72], [35, 73], [35, 74], [35, 75], [35, 76], [35, 77], [35, 78], [35, 79], [35, 80], [35, 81], [35, 82], [36, 70], [36, 71], [36, 72], [36, 73], [36, 74], [36, 75], [36, 76], [36, 77], [36, 78], [36, 79], [36, 80], [36, 81], [36, 82], [37, 70], [37, 71], [37, 72], [37, 73], [37, 74], [37, 75], [37, 76], [37, 77], [37, 78], [37, 79], [37, 80], [37, 81], [37, 82], [38, 70], [38, 71], [38, 72], [38, 73], [38, 74], [38, 75], [38, 76], [38, 77], [38, 78], [38, 79], [38, 80], [38, 81], [38, 82], [39, 70], [39, 71], [39, 72], [39, 73], [39, 74], [39, 75], [39, 76], [39, 77], [39, 78], [39, 79], [39, 80], [39, 81], [39, 82], [40, 70], [40, 71], [40, 72], [40, 73], [40, 74], [40, 75], [40, 76], [40, 77], [40, 78], [40, 79], [40, 80], [40, 81], [40, 82], [41, 70], [41, 71], [41, 72], [41, 73], [41, 74], [41, 75], [41, 76], [41, 77], [41, 78], [41, 79], [41, 80], [41, 81], [41, 82], [42, 70], [42, 71], [42, 72], [42, 73], [42, 74], [42, 75], [42, 76], [42, 77], [42, 78], [42, 79], [42, 80], [42, 81], [42, 82], [43, 70], [43, 71], [43, 72], [43, 73], [43, 74], [43, 75], [43, 76], [43, 77], [43, 78], [43, 79], [43, 80], [43, 81], [43, 82], [44, 70], [44, 71], [44, 72], [44, 73], [44, 74], [44, 75], [44, 76], [44, 77], [44, 78], [44, 79], [44, 80], [44, 81], [44, 82], [45, 70], [45, 71], [45, 72], [45, 73], [45, 74], [45, 75], [45, 76], [45, 77], [45, 78], [45, 79], [45, 80], [45, 81], [45, 82], [46, 70], [46, 71], [46, 72], [46, 73], [46, 74], [46, 75], [46, 76], [46, 77], [46, 78], [46, 79], [46, 80], [46, 81], [46, 82], [47, 70], [47, 71], [47, 72], [47, 73], [47, 74], [47, 75], [47, 76], [47, 77], [47, 78], [47, 79], [47, 80], [47, 81], [47, 82], [48, 70], [48, 71], [48, 72], [48, 73], [48, 74], [48, 75], [48, 76], [48, 77], [48, 78], [48, 79], [48, 80], [48, 81], [48, 82], [49, 70], [49, 71], [49, 72], [49, 73], [49, 74], [49, 75], [49, 76], [49, 77], [49, 78], [49, 79], [49, 80], [49, 81], [49, 82], [50, 70], [50, 71], [50, 72], [50, 73], [50, 74], [50, 75], [50, 76], [50, 77], [50, 78], [50, 79], [50, 80], [50, 81], [50, 82], [51, 70], [51, 71], [51, 72], [51, 73], [51, 74], [51, 75], [51, 76], [51, 77], [51, 78], [51, 79], [51, 80], [51, 81], [51, 82], [52, 70], [52, 71], [52, 72], [52, 73], [52, 74], [52, 75], [52, 76], [52, 77], [52, 78], [52, 79], [52, 80], [52, 81], [52, 82], [53, 71], [53, 72], [53, 73], [53, 74], [53, 75], [53, 76], [53, 77], [53, 78], [53, 79], [53, 80], [53, 81], [53, 82], [54, 72], [54, 73], [54, 74], [54, 75], [54, 76], [54, 77], [54, 78], [54, 79], [54, 80], [54, 81], [54, 82], [55, 73], [55, 74], [55, 75], [55, 76], [55, 77], [55, 78], [55, 79], [55, 80], [55, 81], [55, 82], [56, 74], [56, 75], [56, 76], [56, 77], [56, 78], [56, 79], [56, 80], [56, 81], [56, 82], [57, 75], [57, 76], [57, 77], [57, 78], [57, 79], [57, 80], [57, 81], [57, 82], [58, 76], [58, 77], [58, 78], [58, 79], [58, 80], [58, 81], [58, 82], [59, 77], [59, 78], [59, 79], [59, 80], [59, 81], [59, 82], [60, 80], [60, 81], [60, 82], [61, 81], [61, 82], [62, 82]], 
         4: [[54, 64], [54, 65], [54, 66], [55, 63], [55, 64], [55, 65], [55, 66], [55, 67], [56, 62], [56, 63], [56, 64], [56, 65], [56, 66], [56, 67], [56, 68], [57, 61], [57, 62], [57, 63], [57, 64], [57, 65], [57, 66], [57, 67], [57, 68], [57, 69], [58, 60], [58, 61], [58, 62], [58, 63], [58, 64], [58, 65], [58, 66], [58, 67], [58, 68], [58, 69], [58, 70], [59, 59], [59, 60], [59, 61], [59, 62], [59, 63], [59, 64], [59, 65], [59, 66], [59, 67], [59, 68], [59, 69], [59, 70], [59, 71], [60, 58], [60, 59], [60, 60], [60, 61], [60, 62], [60, 63], [60, 64], [60, 65], [60, 66], [60, 67], [60, 68], [60, 69], [60, 70], [60, 71], [60, 72], [61, 57], [61, 58], [61, 59], [61, 60], [61, 61], [61, 62], [61, 63], [61, 64], [61, 65], [61, 66], [61, 67], [61, 68], [61, 69], [61, 70], [61, 71], [61, 72], [61, 73], [62, 56], [62, 57], [62, 58], [62, 59], [62, 60], [62, 61], [62, 62], [62, 63], [62, 64], [62, 65], [62, 66], [62, 67], [62, 68], [62, 69], [62, 70], [62, 71], [62, 72], [62, 73], [62, 74], [63, 55], [63, 56], [63, 57], [63, 58], [63, 59], [63, 60], [63, 61], [63, 62], [63, 63], [63, 64], [63, 65], [63, 66], [63, 67], [63, 68], [63, 69], [63, 70], [63, 71], [63, 72], [63, 73], [63, 74], [63, 75], [64, 54], [64, 55], [64, 56], [64, 57], [64, 58], [64, 59], [64, 60], [64, 61], [64, 62], [64, 63], [64, 64], [64, 65], [64, 66], [64, 67], [64, 68], [64, 69], [64, 70], [64, 71], [64, 72], [64, 73], [64, 74], [64, 75], [64, 76], [64, 77], [64, 78], [65, 54], [65, 55], [65, 56], [65, 57], [65, 58], [65, 59], [65, 60], [65, 61], [65, 62], [65, 63], [65, 64], [65, 65], [65, 66], [65, 67], [65, 68], [65, 69], [65, 70], [65, 71], [65, 72], [65, 73], [65, 74], [65, 75], [65, 76], [65, 77], [65, 78], [65, 79], [66, 54], [66, 55], [66, 56], [66, 57], [66, 58], [66, 59], [66, 60], [66, 61], [66, 62], [66, 63], [66, 64], [66, 65], [66, 66], [66, 67], [66, 68], [66, 69], [66, 70], [66, 71], [66, 72], [66, 73], [66, 74], [66, 75], [66, 76], [66, 77], [66, 78], [66, 79], [66, 80], [67, 55], [67, 56], [67, 57], [67, 58], [67, 59], [67, 60], [67, 61], [67, 62], [67, 63], [67, 64], [67, 65], [67, 66], [67, 67], [67, 68], [67, 69], [67, 70], [67, 71], [67, 72], [67, 73], [67, 74], [67, 75], [67, 76], [67, 77], [67, 78], [67, 79], [67, 80], [67, 81], [68, 56], [68, 57], [68, 58], [68, 59], [68, 60], [68, 61], [68, 62], [68, 63], [68, 64], [68, 65], [68, 66], [68, 67], [68, 68], [68, 69], [68, 70], [68, 71], [68, 72], [68, 73], [68, 74], [68, 75], [68, 76], [68, 77], [68, 78], [68, 79], [68, 80], [69, 57], [69, 58], [69, 59], [69, 60], [69, 61], [69, 62], [69, 63], [69, 64], [69, 65], [69, 66], [69, 67], [69, 68], [69, 69], [69, 70], [69, 71], [69, 72], [69, 73], [69, 74], [69, 75], [69, 76], [69, 77], [69, 78], [69, 79], [70, 58], [70, 59], [70, 60], [70, 61], [70, 62], [70, 63], [70, 64], [70, 65], [70, 66], [70, 67], [70, 68], [70, 69], [70, 70], [70, 71], [70, 72], [70, 73], [70, 74], [70, 75], [70, 76], [70, 77], [70, 78], [71, 59], [71, 60], [71, 61], [71, 62], [71, 63], [71, 64], [71, 65], [71, 66], [71, 67], [71, 68], [71, 69], [71, 70], [71, 71], [71, 72], [71, 73], [71, 74], [71, 75], [71, 76], [71, 77], [72, 60], [72, 61], [72, 62], [72, 63], [72, 64], [72, 65], [72, 66], [72, 67], [72, 68], [72, 69], [72, 70], [72, 71], [72, 72], [72, 73], [72, 74], [72, 75], [72, 76], [73, 61], [73, 62], [73, 63], [73, 64], [73, 65], [73, 66], [73, 67], [73, 68], [73, 69], [73, 70], [73, 71], [73, 72], [73, 73], [73, 74], [73, 75], [74, 62], [74, 63], [74, 64], [74, 65], [74, 66], [74, 67], [74, 68], [74, 69], [74, 70], [74, 71], [74, 72], [74, 73], [74, 74], [75, 63], [75, 64], [75, 65], [75, 66], [75, 67], [75, 68], [75, 69], [75, 70], [75, 71], [75, 72], [75, 73], [76, 64], [76, 65], [76, 66], [76, 67], [76, 68], [76, 69], [76, 70], [76, 71], [76, 72], [77, 64], [77, 65], [77, 66], [77, 67], [77, 68], [77, 69], [77, 70], [77, 71], [78, 64], [78, 65], [78, 66], [78, 67], [78, 68], [78, 69], [78, 70], [79, 65], [79, 66], [79, 67], [79, 68], [79, 69], [80, 66], [80, 67], [80, 68], [81, 67]], 
         5: [[70, 32], [70, 33], [70, 34], [70, 35], [70, 36], [70, 37], [70, 38], [70, 39], [70, 40], [70, 41], [70, 42], [70, 43], [70, 44], [70, 45], [70, 46], [70, 47], [70, 48], [70, 49], [70, 50], [70, 51], [70, 52], [71, 31], [71, 32], [71, 33], [71, 34], [71, 35], [71, 36], [71, 37], [71, 38], [71, 39], [71, 40], [71, 41], [71, 42], [71, 43], [71, 44], [71, 45], [71, 46], [71, 47], [71, 48], [71, 49], [71, 50], [71, 51], [71, 52], [71, 53], [72, 30], [72, 31], [72, 32], [72, 33], [72, 34], [72, 35], [72, 36], [72, 37], [72, 38], [72, 39], [72, 40], [72, 41], [72, 42], [72, 43], [72, 44], [72, 45], [72, 46], [72, 47], [72, 48], [72, 49], [72, 50], [72, 51], [72, 52], [72, 53], [72, 54], [73, 29], [73, 30], [73, 31], [73, 32], [73, 33], [73, 34], [73, 35], [73, 36], [73, 37], [73, 38], [73, 39], [73, 40], [73, 41], [73, 42], [73, 43], [73, 44], [73, 45], [73, 46], [73, 47], [73, 48], [73, 49], [73, 50], [73, 51], [73, 52], [73, 53], [73, 54], [73, 55], [74, 28], [74, 29], [74, 30], [74, 31], [74, 32], [74, 33], [74, 34], [74, 35], [74, 36], [74, 37], [74, 38], [74, 39], [74, 40], [74, 41], [74, 42], [74, 43], [74, 44], [74, 45], [74, 46], [74, 47], [74, 48], [74, 49], [74, 50], [74, 51], [74, 52], [74, 53], [74, 54], [74, 55], [74, 56], [75, 27], [75, 28], [75, 29], [75, 30], [75, 31], [75, 32], [75, 33], [75, 34], [75, 35], [75, 36], [75, 37], [75, 38], [75, 39], [75, 40], [75, 41], [75, 42], [75, 43], [75, 44], [75, 45], [75, 46], [75, 47], [75, 48], [75, 49], [75, 50], [75, 51], [75, 52], [75, 53], [75, 54], [75, 55], [75, 56], [75, 57], [76, 26], [76, 27], [76, 28], [76, 29], [76, 30], [76, 31], [76, 32], [76, 33], [76, 34], [76, 35], [76, 36], [76, 37], [76, 38], [76, 39], [76, 40], [76, 41], [76, 42], [76, 43], [76, 44], [76, 45], [76, 46], [76, 47], [76, 48], [76, 49], [76, 50], [76, 51], [76, 52], [76, 53], [76, 54], [76, 55], [76, 56], [76, 57], [76, 58], [77, 25], [77, 26], [77, 27], [77, 28], [77, 29], [77, 30], [77, 31], [77, 32], [77, 33], [77, 34], [77, 35], [77, 36], [77, 37], [77, 38], [77, 39], [77, 40], [77, 41], [77, 42], [77, 43], [77, 44], [77, 45], [77, 46], [77, 47], [77, 48], [77, 49], [77, 50], [77, 51], [77, 52], [77, 53], [77, 54], [77, 55], [77, 56], [77, 57], [77, 58], [77, 59], [78, 25], [78, 26], [78, 27], [78, 28], [78, 29], [78, 30], [78, 31], [78, 32], [78, 33], [78, 34], [78, 35], [78, 36], [78, 37], [78, 38], [78, 39], [78, 40], [78, 41], [78, 42], [78, 43], [78, 44], [78, 45], [78, 46], [78, 47], [78, 48], [78, 49], [78, 50], [78, 51], [78, 52], [78, 53], [78, 54], [78, 55], [78, 56], [78, 57], [78, 58], [78, 59], [79, 25], [79, 26], [79, 27], [79, 28], [79, 29], [79, 30], [79, 31], [79, 32], [79, 33], [79, 34], [79, 35], [79, 36], [79, 37], [79, 38], [79, 39], [79, 40], [79, 41], [79, 42], [79, 43], [79, 44], [79, 45], [79, 46], [79, 47], [79, 48], [79, 49], [79, 50], [79, 51], [79, 52], [79, 53], [79, 54], [79, 55], [79, 56], [79, 57], [79, 58], [79, 59], [80, 24], [80, 25], [80, 26], [80, 27], [80, 28], [80, 29], [80, 30], [80, 31], [80, 32], [80, 33], [80, 34], [80, 35], [80, 36], [80, 37], [80, 38], [80, 39], [80, 40], [80, 41], [80, 42], [80, 43], [80, 44], [80, 45], [80, 46], [80, 47], [80, 48], [80, 49], [80, 50], [80, 51], [80, 52], [80, 53], [80, 54], [80, 55], [80, 56], [80, 57], [80, 58], [80, 59], [80, 60], [81, 23], [81, 24], [81, 25], [81, 26], [81, 27], [81, 28], [81, 29], [81, 30], [81, 31], [81, 32], [81, 33], [81, 34], [81, 35], [81, 36], [81, 37], [81, 38], [81, 39], [81, 40], [81, 41], [81, 42], [81, 43], [81, 44], [81, 45], [81, 46], [81, 47], [81, 48], [81, 49], [81, 50], [81, 51], [81, 52], [81, 53], [81, 54], [81, 55], [81, 56], [81, 57], [81, 58], [81, 59], [81, 60], [81, 61], [82, 22], [82, 23], [82, 24], [82, 25], [82, 26], [82, 27], [82, 28], [82, 29], [82, 30], [82, 31], [82, 32], [82, 33], [82, 34], [82, 35], [82, 36], [82, 37], [82, 38], [82, 39], [82, 40], [82, 41], [82, 42], [82, 43], [82, 44], [82, 45], [82, 46], [82, 47], [82, 48], [82, 49], [82, 50], [82, 51], [82, 52], [82, 53], [82, 54], [82, 55], [82, 56], [82, 57], [82, 58], [82, 59], [82, 60], [82, 61], [82, 62]], 
         6: [[54, 18], [54, 19], [54, 20], [55, 17], [55, 18], [55, 19], [55, 20], [55, 21], [56, 16], [56, 17], [56, 18], [56, 19], [56, 20], [56, 21], [56, 22], [57, 15], [57, 16], [57, 17], [57, 18], [57, 19], [57, 20], [57, 21], [57, 22], [57, 23], [58, 14], [58, 15], [58, 16], [58, 17], [58, 18], [58, 19], [58, 20], [58, 21], [58, 22], [58, 23], [58, 24], [59, 13], [59, 14], [59, 15], [59, 16], [59, 17], [59, 18], [59, 19], [59, 20], [59, 21], [59, 22], [59, 23], [59, 24], [59, 25], [60, 12], [60, 13], [60, 14], [60, 15], [60, 16], [60, 17], [60, 18], [60, 19], [60, 20], [60, 21], [60, 22], [60, 23], [60, 24], [60, 25], [60, 26], [61, 11], [61, 12], [61, 13], [61, 14], [61, 15], [61, 16], [61, 17], [61, 18], [61, 19], [61, 20], [61, 21], [61, 22], [61, 23], [61, 24], [61, 25], [61, 26], [61, 27], [62, 10], [62, 11], [62, 12], [62, 13], [62, 14], [62, 15], [62, 16], [62, 17], [62, 18], [62, 19], [62, 20], [62, 21], [62, 22], [62, 23], [62, 24], [62, 25], [62, 26], [62, 27], [62, 28], [63, 9], [63, 10], [63, 11], [63, 12], [63, 13], [63, 14], [63, 15], [63, 16], [63, 17], [63, 18], [63, 19], [63, 20], [63, 21], [63, 22], [63, 23], [63, 24], [63, 25], [63, 26], [63, 27], [63, 28], [63, 29], [64, 6], [64, 7], [64, 8], [64, 9], [64, 10], [64, 11], [64, 12], [64, 13], [64, 14], [64, 15], [64, 16], [64, 17], [64, 18], [64, 19], [64, 20], [64, 21], [64, 22], [64, 23], [64, 24], [64, 25], [64, 26], [64, 27], [64, 28], [64, 29], [64, 30], [65, 5], [65, 6], [65, 7], [65, 8], [65, 9], [65, 10], [65, 11], [65, 12], [65, 13], [65, 14], [65, 15], [65, 16], [65, 17], [65, 18], [65, 19], [65, 20], [65, 21], [65, 22], [65, 23], [65, 24], [65, 25], [65, 26], [65, 27], [65, 28], [65, 29], [65, 30], [66, 4], [66, 5], [66, 6], [66, 7], [66, 8], [66, 9], [66, 10], [66, 11], [66, 12], [66, 13], [66, 14], [66, 15], [66, 16], [66, 17], [66, 18], [66, 19], [66, 20], [66, 21], [66, 22], [66, 23], [66, 24], [66, 25], [66, 26], [66, 27], [66, 28], [66, 29], [66, 30], [67, 3], [67, 4], [67, 5], [67, 6], [67, 7], [67, 8], [67, 9], [67, 10], [67, 11], [67, 12], [67, 13], [67, 14], [67, 15], [67, 16], [67, 17], [67, 18], [67, 19], [67, 20], [67, 21], [67, 22], [67, 23], [67, 24], [67, 25], [67, 26], [67, 27], [67, 28], [67, 29], [68, 4], [68, 5], [68, 6], [68, 7], [68, 8], [68, 9], [68, 10], [68, 11], [68, 12], [68, 13], [68, 14], [68, 15], [68, 16], [68, 17], [68, 18], [68, 19], [68, 20], [68, 21], [68, 22], [68, 23], [68, 24], [68, 25], [68, 26], [68, 27], [68, 28], [69, 5], [69, 6], [69, 7], [69, 8], [69, 9], [69, 10], [69, 11], [69, 12], [69, 13], [69, 14], [69, 15], [69, 16], [69, 17], [69, 18], [69, 19], [69, 20], [69, 21], [69, 22], [69, 23], [69, 24], [69, 25], [69, 26], [69, 27], [70, 6], [70, 7], [70, 8], [70, 9], [70, 10], [70, 11], [70, 12], [70, 13], [70, 14], [70, 15], [70, 16], [70, 17], [70, 18], [70, 19], [70, 20], [70, 21], [70, 22], [70, 23], [70, 24], [70, 25], [70, 26], [71, 7], [71, 8], [71, 9], [71, 10], [71, 11], [71, 12], [71, 13], [71, 14], [71, 15], [71, 16], [71, 17], [71, 18], [71, 19], [71, 20], [71, 21], [71, 22], [71, 23], [71, 24], [71, 25], [72, 8], [72, 9], [72, 10], [72, 11], [72, 12], [72, 13], [72, 14], [72, 15], [72, 16], [72, 17], [72, 18], [72, 19], [72, 20], [72, 21], [72, 22], [72, 23], [72, 24], [73, 9], [73, 10], [73, 11], [73, 12], [73, 13], [73, 14], [73, 15], [73, 16], [73, 17], [73, 18], [73, 19], [73, 20], [73, 21], [73, 22], [73, 23], [74, 10], [74, 11], [74, 12], [74, 13], [74, 14], [74, 15], [74, 16], [74, 17], [74, 18], [74, 19], [74, 20], [74, 21], [74, 22], [75, 11], [75, 12], [75, 13], [75, 14], [75, 15], [75, 16], [75, 17], [75, 18], [75, 19], [75, 20], [75, 21], [76, 12], [76, 13], [76, 14], [76, 15], [76, 16], [76, 17], [76, 18], [76, 19], [76, 20], [77, 13], [77, 14], [77, 15], [77, 16], [77, 17], [77, 18], [77, 19], [77, 20], [78, 14], [78, 15], [78, 16], [78, 17], [78, 18], [78, 19], [78, 20], [79, 15], [79, 16], [79, 17], [79, 18], [79, 19], [80, 16], [80, 17], [80, 18], [81, 17]], 
         7: [[22, 2], [23, 2], [23, 3], [24, 2], [24, 3], [24, 4], [25, 2], [25, 3], [25, 4], [25, 5], [25, 6], [25, 7], [26, 2], [26, 3], [26, 4], [26, 5], [26, 6], [26, 7], [26, 8], [27, 2], [27, 3], [27, 4], [27, 5], [27, 6], [27, 7], [27, 8], [27, 9], [28, 2], [28, 3], [28, 4], [28, 5], [28, 6], [28, 7], [28, 8], [28, 9], [28, 10], [29, 2], [29, 3], [29, 4], [29, 5], [29, 6], [29, 7], [29, 8], [29, 9], [29, 10], [29, 11], [30, 2], [30, 3], [30, 4], [30, 5], [30, 6], [30, 7], [30, 8], [30, 9], [30, 10], [30, 11], [30, 12], [31, 2], [31, 3], [31, 4], [31, 5], [31, 6], [31, 7], [31, 8], [31, 9], [31, 10], [31, 11], [31, 12], [31, 13], [32, 2], [32, 3], [32, 4], [32, 5], [32, 6], [32, 7], [32, 8], [32, 9], [32, 10], [32, 11], [32, 12], [32, 13], [32, 14], [33, 2], [33, 3], [33, 4], [33, 5], [33, 6], [33, 7], [33, 8], [33, 9], [33, 10], [33, 11], [33, 12], [33, 13], [33, 14], [34, 2], [34, 3], [34, 4], [34, 5], [34, 6], [34, 7], [34, 8], [34, 9], [34, 10], [34, 11], [34, 12], [34, 13], [34, 14], [35, 2], [35, 3], [35, 4], [35, 5], [35, 6], [35, 7], [35, 8], [35, 9], [35, 10], [35, 11], [35, 12], [35, 13], [35, 14], [36, 2], [36, 3], [36, 4], [36, 5], [36, 6], [36, 7], [36, 8], [36, 9], [36, 10], [36, 11], [36, 12], [36, 13], [36, 14], [37, 2], [37, 3], [37, 4], [37, 5], [37, 6], [37, 7], [37, 8], [37, 9], [37, 10], [37, 11], [37, 12], [37, 13], [37, 14], [38, 2], [38, 3], [38, 4], [38, 5], [38, 6], [38, 7], [38, 8], [38, 9], [38, 10], [38, 11], [38, 12], [38, 13], [38, 14], [39, 2], [39, 3], [39, 4], [39, 5], [39, 6], [39, 7], [39, 8], [39, 9], [39, 10], [39, 11], [39, 12], [39, 13], [39, 14], [40, 2], [40, 3], [40, 4], [40, 5], [40, 6], [40, 7], [40, 8], [40, 9], [40, 10], [40, 11], [40, 12], [40, 13], [40, 14], [41, 2], [41, 3], [41, 4], [41, 5], [41, 6], [41, 7], [41, 8], [41, 9], [41, 10], [41, 11], [41, 12], [41, 13], [41, 14], [42, 2], [42, 3], [42, 4], [42, 5], [42, 6], [42, 7], [42, 8], [42, 9], [42, 10], [42, 11], [42, 12], [42, 13], [42, 14], [43, 2], [43, 3], [43, 4], [43, 5], [43, 6], [43, 7], [43, 8], [43, 9], [43, 10], [43, 11], [43, 12], [43, 13], [43, 14], [44, 2], [44, 3], [44, 4], [44, 5], [44, 6], [44, 7], [44, 8], [44, 9], [44, 10], [44, 11], [44, 12], [44, 13], [44, 14], [45, 2], [45, 3], [45, 4], [45, 5], [45, 6], [45, 7], [45, 8], [45, 9], [45, 10], [45, 11], [45, 12], [45, 13], [45, 14], [46, 2], [46, 3], [46, 4], [46, 5], [46, 6], [46, 7], [46, 8], [46, 9], [46, 10], [46, 11], [46, 12], [46, 13], [46, 14], [47, 2], [47, 3], [47, 4], [47, 5], [47, 6], [47, 7], [47, 8], [47, 9], [47, 10], [47, 11], [47, 12], [47, 13], [47, 14], [48, 2], [48, 3], [48, 4], [48, 5], [48, 6], [48, 7], [48, 8], [48, 9], [48, 10], [48, 11], [48, 12], [48, 13], [48, 14], [49, 2], [49, 3], [49, 4], [49, 5], [49, 6], [49, 7], [49, 8], [49, 9], [49, 10], [49, 11], [49, 12], [49, 13], [49, 14], [50, 2], [50, 3], [50, 4], [50, 5], [50, 6], [50, 7], [50, 8], [50, 9], [50, 10], [50, 11], [50, 12], [50, 13], [50, 14], [51, 2], [51, 3], [51, 4], [51, 5], [51, 6], [51, 7], [51, 8], [51, 9], [51, 10], [51, 11], [51, 12], [51, 13], [51, 14], [52, 2], [52, 3], [52, 4], [52, 5], [52, 6], [52, 7], [52, 8], [52, 9], [52, 10], [52, 11], [52, 12], [52, 13], [52, 14], [53, 2], [53, 3], [53, 4], [53, 5], [53, 6], [53, 7], [53, 8], [53, 9], [53, 10], [53, 11], [53, 12], [53, 13], [54, 2], [54, 3], [54, 4], [54, 5], [54, 6], [54, 7], [54, 8], [54, 9], [54, 10], [54, 11], [54, 12], [55, 2], [55, 3], [55, 4], [55, 5], [55, 6], [55, 7], [55, 8], [55, 9], [55, 10], [55, 11], [56, 2], [56, 3], [56, 4], [56, 5], [56, 6], [56, 7], [56, 8], [56, 9], [56, 10], [57, 2], [57, 3], [57, 4], [57, 5], [57, 6], [57, 7], [57, 8], [57, 9], [58, 2], [58, 3], [58, 4], [58, 5], [58, 6], [58, 7], [58, 8], [59, 2], [59, 3], [59, 4], [59, 5], [59, 6], [59, 7], [60, 2], [60, 3], [60, 4], [61, 2], [61, 3], [62, 2]], 
         8: [[3, 17], [4, 16], [4, 17], [4, 18], [5, 15], [5, 16], [5, 17], [5, 18], [5, 19], [6, 14], [6, 15], [6, 16], [6, 17], [6, 18], [6, 19], [6, 20], [7, 13], [7, 14], [7, 15], [7, 16], [7, 17], [7, 18], [7, 19], [7, 20], [7, 21], [8, 12], [8, 13], [8, 14], [8, 15], [8, 16], [8, 17], [8, 18], [8, 19], [8, 20], [8, 21], [9, 11], [9, 12], [9, 13], [9, 14], [9, 15], [9, 16], [9, 17], [9, 18], [9, 19], [9, 20], [9, 21], [10, 10], [10, 11], [10, 12], [10, 13], [10, 14], [10, 15], [10, 16], [10, 17], [10, 18], [10, 19], [10, 20], [10, 21], [10, 22], [11, 9], [11, 10], [11, 11], [11, 12], [11, 13], [11, 14], [11, 15], [11, 16], [11, 17], [11, 18], [11, 19], [11, 20], [11, 21], [11, 22], [11, 23], [12, 8], [12, 9], [12, 10], [12, 11], [12, 12], [12, 13], [12, 14], [12, 15], [12, 16], [12, 17], [12, 18], [12, 19], [12, 20], [12, 21], [12, 22], [12, 23], [12, 24], [13, 7], [13, 8], [13, 9], [13, 10], [13, 11], [13, 12], [13, 13], [13, 14], [13, 15], [13, 16], [13, 17], [13, 18], [13, 19], [13, 20], [13, 21], [13, 22], [13, 23], [13, 24], [13, 25], [14, 6], [14, 7], [14, 8], [14, 9], [14, 10], [14, 11], [14, 12], [14, 13], [14, 14], [14, 15], [14, 16], [14, 17], [14, 18], [14, 19], [14, 20], [14, 21], [14, 22], [14, 23], [14, 24], [14, 25], [14, 26], [15, 5], [15, 6], [15, 7], [15, 8], [15, 9], [15, 10], [15, 11], [15, 12], [15, 13], [15, 14], [15, 15], [15, 16], [15, 17], [15, 18], [15, 19], [15, 20], [15, 21], [15, 22], [15, 23], [15, 24], [15, 25], [15, 26], [15, 27], [16, 4], [16, 5], [16, 6], [16, 7], [16, 8], [16, 9], [16, 10], [16, 11], [16, 12], [16, 13], [16, 14], [16, 15], [16, 16], [16, 17], [16, 18], [16, 19], [16, 20], [16, 21], [16, 22], [16, 23], [16, 24], [16, 25], [16, 26], [16, 27], [16, 28], [17, 3], [17, 4], [17, 5], [17, 6], [17, 7], [17, 8], [17, 9], [17, 10], [17, 11], [17, 12], [17, 13], [17, 14], [17, 15], [17, 16], [17, 17], [17, 18], [17, 19], [17, 20], [17, 21], [17, 22], [17, 23], [17, 24], [17, 25], [17, 26], [17, 27], [17, 28], [17, 29], [18, 4], [18, 5], [18, 6], [18, 7], [18, 8], [18, 9], [18, 10], [18, 11], [18, 12], [18, 13], [18, 14], [18, 15], [18, 16], [18, 17], [18, 18], [18, 19], [18, 20], [18, 21], [18, 22], [18, 23], [18, 24], [18, 25], [18, 26], [18, 27], [18, 28], [18, 29], [18, 30], [19, 5], [19, 6], [19, 7], [19, 8], [19, 9], [19, 10], [19, 11], [19, 12], [19, 13], [19, 14], [19, 15], [19, 16], [19, 17], [19, 18], [19, 19], [19, 20], [19, 21], [19, 22], [19, 23], [19, 24], [19, 25], [19, 26], [19, 27], [19, 28], [19, 29], [19, 30], [20, 6], [20, 7], [20, 8], [20, 9], [20, 10], [20, 11], [20, 12], [20, 13], [20, 14], [20, 15], [20, 16], [20, 17], [20, 18], [20, 19], [20, 20], [20, 21], [20, 22], [20, 23], [20, 24], [20, 25], [20, 26], [20, 27], [20, 28], [20, 29], [20, 30], [21, 9], [21, 10], [21, 11], [21, 12], [21, 13], [21, 14], [21, 15], [21, 16], [21, 17], [21, 18], [21, 19], [21, 20], [21, 21], [21, 22], [21, 23], [21, 24], [21, 25], [21, 26], [21, 27], [21, 28], [21, 29], [22, 10], [22, 11], [22, 12], [22, 13], [22, 14], [22, 15], [22, 16], [22, 17], [22, 18], [22, 19], [22, 20], [22, 21], [22, 22], [22, 23], [22, 24], [22, 25], [22, 26], [22, 27], [22, 28], [23, 11], [23, 12], [23, 13], [23, 14], [23, 15], [23, 16], [23, 17], [23, 18], [23, 19], [23, 20], [23, 21], [23, 22], [23, 23], [23, 24], [23, 25], [23, 26], [23, 27], [24, 12], [24, 13], [24, 14], [24, 15], [24, 16], [24, 17], [24, 18], [24, 19], [24, 20], [24, 21], [24, 22], [24, 23], [24, 24], [24, 25], [24, 26], [25, 13], [25, 14], [25, 15], [25, 16], [25, 17], [25, 18], [25, 19], [25, 20], [25, 21], [25, 22], [25, 23], [25, 24], [25, 25], [26, 14], [26, 15], [26, 16], [26, 17], [26, 18], [26, 19], [26, 20], [26, 21], [26, 22], [26, 23], [26, 24], [27, 15], [27, 16], [27, 17], [27, 18], [27, 19], [27, 20], [27, 21], [27, 22], [27, 23], [28, 16], [28, 17], [28, 18], [28, 19], [28, 20], [28, 21], [28, 22], [29, 17], [29, 18], [29, 19], [29, 20], [29, 21], [30, 18], [30, 19], [30, 20]]}

def make_game(level, reward_config):
  """Builds and returns a Better Scrolly Maze game for the selected level."""
  maze_ascii = MAZES_ART[level]

  # change location of fixed object in all the rooms
  for row in range(1,85):
    if 'a' in maze_ascii[row]:
      maze_ascii[row] = maze_ascii[row].replace('a', ' ', 1)
      new_coord = random.sample(ROOMS[1], 1)[0]
      maze_ascii[new_coord[0]] = maze_ascii[new_coord[0]][:new_coord[1]] + 'a' + maze_ascii[new_coord[0]][new_coord[1]+1:]
    if 'b' in maze_ascii[row]:
      maze_ascii[row] = maze_ascii[row].replace('b', ' ', 1)
      new_coord = random.sample(ROOMS[2], 1)[0]
      maze_ascii[new_coord[0]] = maze_ascii[new_coord[0]][:new_coord[1]] + 'b' + maze_ascii[new_coord[0]][new_coord[1]+1:]
    if 'c' in maze_ascii[row]:
      maze_ascii[row] = maze_ascii[row].replace('c', ' ', 1)
      new_coord = random.sample(ROOMS[3], 1)[0]
      maze_ascii[new_coord[0]] = maze_ascii[new_coord[0]][:new_coord[1]] + 'c' + maze_ascii[new_coord[0]][new_coord[1]+1:]
    if 'd' in maze_ascii[row]:
      maze_ascii[row] = maze_ascii[row].replace('d', ' ', 1)
      new_coord = random.sample(ROOMS[4], 1)[0]
      maze_ascii[new_coord[0]] = maze_ascii[new_coord[0]][:new_coord[1]] + 'd' + maze_ascii[new_coord[0]][new_coord[1]+1:]
    if 'e' in maze_ascii[row]:
      maze_ascii[row] = maze_ascii[row].replace('e', ' ', 1)
      new_coord = random.sample(ROOMS[5], 1)[0]
      maze_ascii[new_coord[0]] = maze_ascii[new_coord[0]][:new_coord[1]] + 'e' + maze_ascii[new_coord[0]][new_coord[1]+1:]
    if 'f' in maze_ascii[row]:
      maze_ascii[row] = maze_ascii[row].replace('f', ' ', 1)
      new_coord = random.sample(ROOMS[6], 1)[0]
      maze_ascii[new_coord[0]] = maze_ascii[new_coord[0]][:new_coord[1]] + 'f' + maze_ascii[new_coord[0]][new_coord[1]+1:]
    if 'g' in maze_ascii[row]:
      maze_ascii[row] = maze_ascii[row].replace('g', ' ', 1)
      new_coord = random.sample(ROOMS[7], 1)[0]
      maze_ascii[new_coord[0]] = maze_ascii[new_coord[0]][:new_coord[1]] + 'g' + maze_ascii[new_coord[0]][new_coord[1]+1:]
    if 'h' in maze_ascii[row]:
      maze_ascii[row] = maze_ascii[row].replace('h', ' ', 1)
      new_coord = random.sample(ROOMS[8], 1)[0]
      maze_ascii[new_coord[0]] = maze_ascii[new_coord[0]][:new_coord[1]] + 'h' + maze_ascii[new_coord[0]][new_coord[1]+1:]

  a, b, c, d, e, f, g, h = reward_config.values()
  return ascii_art.ascii_art_to_game(
      maze_ascii, what_lies_beneath=' ',
      sprites={
          'P': ascii_art.Partial(PlayerSprite, a=a, b=b, c=c, d=d, e=e, f=f, g=g, h=h),
          'a': FixedObject,
          'b': FixedObject,
          'c': FixedObject,
          'd': FixedObject,
          'e': FixedObject,
          'f': FixedObject,
          'g': FixedObject,
          'h': FixedObject},
      update_schedule=['P', 'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h'],
      z_order='abcdefghP')

def make_croppers(level):
  """Builds and returns `ObservationCropper`s for the selected level.

  We make one cropper for each level: centred on the player. Room
  to add more if needed.

  Args:
    level: level to make `ObservationCropper`s for.

  Returns:
    a list of all the `ObservationCropper`s needed.
  """
  return [
      # The player view.
      cropping.ScrollingCropper(rows=5, cols=5, to_track=['P']),
  ]

class PlayerSprite(prefab_sprites.MazeWalker):
  """A `Sprite` for our player, the maze explorer."""

  def __init__(self, corner, position, character, a, b, c, d, e, f, g, h):
    """Constructor: just tells `MazeWalker` we can't walk through walls or objects."""
    super(PlayerSprite, self).__init__(
        corner, position, character, impassable='#abcdefgh')
    self.a_reward = a
    self.b_reward = b
    self.c_reward = c
    self.d_reward = d
    self.e_reward = e
    self.f_reward = f
    self.g_reward = g
    self.h_reward = h

  def update(self, actions, board, layers, backdrop, things, the_plot):
    del backdrop, layers  # Unused

    if actions == 0:    # go upward?
      self._north(board, the_plot)
    elif actions == 1:  # go downward?
      self._south(board, the_plot)
    elif actions == 2:  # go leftward?
      self._west(board, the_plot)
    elif actions == 3:  # go rightward?
      self._east(board, the_plot)
    elif actions == 4:  # stay put? (Not strictly necessary.)
      self._stay(board, the_plot)
    if actions == 5:    # just quit?
      the_plot.terminate_episode()

    pr, pc = self.position

    ar, ac = things['a'].position
    br, bc = things['b'].position
    cr, cc = things['c'].position
    dr, dc = things['d'].position
    er, ec = things['e'].position
    fr, fc = things['f'].position
    gr, gc = things['g'].position
    hr, hc = things['h'].position
    if ((ar-1) <= pr <= (ar+1)) and ((ac-1) <= pc <= (ac+1)):
      the_plot.add_reward(self.a_reward)
    elif ((br-1) <= pr <= (br+1)) and ((bc-1) <= pc <= (bc+1)):
      the_plot.add_reward(self.b_reward)
    elif ((cr-1) <= pr <= (cr+1)) and ((cc-1) <= pc <= (cc+1)):
      the_plot.add_reward(self.c_reward)
    elif ((dr-1) <= pr <= (dr+1)) and ((dc-1) <= pc <= (dc+1)):
      the_plot.add_reward(self.d_reward)
    elif ((er-1) <= pr <= (er+1)) and ((ec-1) <= pc <= (ec+1)):
      the_plot.add_reward(self.e_reward)
    elif ((fr-1) <= pr <= (fr+1)) and ((fc-1) <= pc <= (fc+1)):
      the_plot.add_reward(self.f_reward)
    elif ((gr-1) <= pr <= (gr+1)) and ((gc-1) <= pc <= (gc+1)):
      the_plot.add_reward(self.g_reward)
    elif ((hr-1) <= pr <= (hr+1)) and ((hc-1) <= pc <= (hc+1)):
      the_plot.add_reward(self.h_reward)

class FixedObject(plab_things.Sprite):
  """Static object. Doesn't move."""

  def __init__(self, corner, position, character):
    super(FixedObject, self).__init__(
        corner, position, character)

  def update(self, actions, board, layers, backdrop, things, the_plot):
    del actions, backdrop  # Unused.

def main(argv=()):
  level = int(argv[1]) if len(argv) > 1 else 0

  # Build the game.
  game = make_game(level)
  # Build the croppers we'll use to scroll around in it, etc.
  croppers = make_croppers(level)

  # Make a CursesUi to play it with.
  ui = human_ui.CursesUi(
      keys_to_actions={curses.KEY_UP: 0, curses.KEY_DOWN: 1,
                       curses.KEY_LEFT: 2, curses.KEY_RIGHT: 3,
                       -1: 4,
                       'q': 5, 'Q': 5},
      delay=100, colour_fg=COLOUR_FG, colour_bg=COLOUR_BG,
      croppers=croppers)

  # Let the game begin!
  ui.play(game)


if __name__ == '__main__':
  main(sys.argv)
